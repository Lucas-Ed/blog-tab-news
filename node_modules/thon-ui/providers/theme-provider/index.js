"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},react_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.ThemeProvider=exports.ThemeContext=void 0,__importDefault(require("react"))),hooks_1=require("../../hooks"),use_shortcut_1=require("../../hooks/use-shortcut"),STORAGE_THEME_KEY="themeConfiguration",defaultThemeConfiguration={theme:"light",mode:"auto"},ThemeProvider=(exports.ThemeContext=react_1.default.createContext({theme:defaultThemeConfiguration.theme,themeConfiguration:defaultThemeConfiguration,setTheme:function(){},setThemeFromSystem:function(){},toggleTheme:function(){}}),function(e){var t=e.storageKey,o=e.enableShortcut,r=void 0===o||o,o=e.children,e=(0,hooks_1.useLocalStorage)(void 0===t?STORAGE_THEME_KEY:t,defaultThemeConfiguration),a=e[0],n=e[1];function i(e){n(e),document.body.classList.remove("dark","light"),document.body.classList.add(e.theme)}function u(e){i({theme:e,mode:"manual"})}function m(){window.matchMedia?i({theme:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",mode:"auto"}):i(defaultThemeConfiguration)}return(0,use_shortcut_1.useShortcut)([{keys:["l"],addCtrlModifier:!0,callback:function(){return r&&u("dark"===a.theme?"light":"dark")}}]),react_1.default.useEffect(function(){var e="manual"===a.mode&&a.theme;function t(e){var t=e.newValue;e.key===STORAGE_THEME_KEY&&n(t?JSON.parse(t):defaultThemeConfiguration)}return e?i({theme:e,mode:"manual"}):m(),window.addEventListener("storage",t),function(){window.removeEventListener("storage",t)}},[]),react_1.default.createElement(exports.ThemeContext.Provider,{value:{theme:a.theme,themeConfiguration:a,setTheme:u,setThemeFromSystem:m,toggleTheme:function(){i({theme:"dark"===a.theme?"light":"dark",mode:"manual"})}}},o)});exports.ThemeProvider=ThemeProvider;